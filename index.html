<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bill Layne Insurance - Document Generator & Resources</title>
  <link rel="stylesheet" href="css/styles.css">
  <!-- PDF.js for PDF viewing (optional) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  
  <!-- Authentication Check -->
  <script>
    // Check if user is authenticated
    if (sessionStorage.getItem('authenticated') !== 'true') {
      // Redirect to login page
      window.location.href = 'login.html';
    }
  </script>
</head>
<body>
  <!-- Navigation Tabs -->
  <div class="navigation-tabs">
    <button class="tab-button active" onclick="showTab('generator')">Document Generator</button>
    <button class="tab-button" onclick="showTab('templates')">PDF Templates</button>
    <button class="tab-button" onclick="showTab('resources')">Resources</button>
    <button class="tab-button" onclick="showTab('prompts')">Prompt Manager</button>
    <button class="tab-button" onclick="showTab('snl')">SNL</button>
    <button class="tab-button" onclick="showTab('cancellation')">Cancellation</button>
    <button class="tab-button" onclick="logout()" style="float: right; background: linear-gradient(180deg, #e74c3c 0%, #c0392b 100%); border-color: #a93226;">Logout</button>
  </div>

  <!-- Document Generator Tab (main content) -->
  <div id="generator-tab" class="tab-content active">
    <div class="form-container">
      <h2>Insurance Document Generator - Multi-Template</h2>
      
      <!-- Template Selector -->
      <div class="template-selector">
        <label for="documentType">Select Document Type:</label>
        <select id="documentType" onchange="switchTemplate()">
          <option value="closing">Home Closing Package (Declaration & Invoice)</option>
          <option value="binder">Binder Letter</option>
          <option value="mortgagee-change">Mortgagee Change Letter</option>
          <option value="cancellation">Cancellation Notice</option>
          <option value="renewal">Renewal Notice</option>
          <option value="coverage-change">Coverage Change Confirmation</option>
          <option value="payment-receipt">Payment Receipt</option>
          <option value="claim-info">Claim Information Sheet</option>
          <option value="dl123">DL-123 Driver License Insurance Certification</option>
          <option value="underwriting">Underwriting Email Template</option>
          <option value="letterhead">Professional Letterhead</option>
          <option value="envelope">Envelope</option>
          <option value="auto-id-card">Auto ID Card Maker</option>
        </select>
      </div>

      <!-- Template Description -->
      <div id="templateDescription" class="template-description">
        Select a document type above to begin. Each template is designed for specific insurance documentation needs.
      </div>
      
      <!-- Save/Load buttons -->
      <div class="no-print" style="text-align: right; margin-bottom: 20px;">
        <button type="button" onclick="saveFormData()" class="save-btn">üíæ Save Form Data</button>
        <button type="button" onclick="loadFormData()" class="load-btn">üìÇ Load Saved Data</button>
        <button type="button" onclick="clearForm()" class="clear-btn">üóëÔ∏è Clear Form</button>
      </div>

      <!-- Common Fields Section (shown for all templates) -->
      <div class="form-section active" id="commonFields">
        <div class="section-title">Agency & Company Information</div>
        <div class="form-row">
          <div class="form-group">
            <label>Insurance Company</label>
            <select id="insuranceCompany" onchange="updateAgencyCodeDL123()">
              <option value="">Select Company</option>
              <option value="Nationwide">Nationwide</option>
              <option value="Progressive">Progressive</option>
              <option value="National General">National General</option>
              <option value="Alamance">Alamance</option>
              <option value="Travelers">Travelers</option>
              <option value="NC Grange Mutual">NC Grange Mutual</option>
              <option value="Universal Property">Universal Property</option>
              <option value="Dairyland">Dairyland</option>
              <option value="Allstate">Allstate</option>
              <option value="Foremost">Foremost</option>
              <option value="JSA">JSA</option>
              <option value="NCJUA">NCJUA</option>
            </select>
          </div>
          <div class="form-group">
            <label>Policy Number</label>
            <input type="text" id="policyNumber" />
          </div>
        </div>
      </div>

      <!-- Insured Information (most templates) -->
      <div class="form-section" id="insuredSection">
        <div class="section-title">Insured Information</div>
        <div class="form-row">
          <div class="form-group">
            <label>Policyholder Name</label>
            <input type="text" id="policyholderName" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Address Line 1</label>
            <input type="text" id="addressLine1" />
          </div>
          <div class="form-group">
            <label>Address Line 2</label>
            <input type="text" id="addressLine2" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>City</label>
            <input type="text" id="city" />
          </div>
          <div class="form-group">
            <label>State</label>
            <input type="text" id="state" value="NC" />
          </div>
          <div class="form-group">
            <label>ZIP Code</label>
            <input type="text" id="zipCode" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Phone Number</label>
            <input type="tel" id="phoneNumber" />
          </div>
          <div class="form-group">
            <label>Email</label>
            <input type="email" id="emailAddress" />
          </div>
        </div>
      </div>

      <!-- Policy Dates Section -->
      <div class="form-section" id="policyDatesSection">
        <div class="section-title">Policy Dates</div>
        <div class="form-row">
          <div class="form-group">
            <label>Effective Date</label>
            <input type="date" id="effectiveDate" onchange="updateExpirationDate()" />
          </div>
          <div class="form-group">
            <label>Expiration Date</label>
            <input type="date" id="expirationDate" />
          </div>
        </div>
      </div>

      <!-- Coverage Information (for closing, binder, renewal, coverage change) -->
      <div class="form-section" id="coverageSection">
        <div class="section-title">Coverage Information</div>
        <div class="form-row">
          <div class="form-group">
            <label>Coverage A - Dwelling</label>
            <input type="number" id="coverageA" min="0" step="1000" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Deductible</label>
            <input type="number" id="deductible" min="0" step="100" />
          </div>
          <div class="form-group">
            <label>Annual Premium</label>
            <input type="number" id="annualPremium" min="0" step="0.01" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Wind and Hail Deductible</label>
            <input type="text" id="windHailDeductible" placeholder="e.g., 1% or $2500" />
          </div>
          <div class="form-group">
            <label>Replacement Cost</label>
            <select id="replacementCost">
              <option value="100%">100%</option>
              <option value="125%">125%</option>
              <option value="150%">150%</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Mortgage Information -->
      <div class="form-section" id="mortgageeSection">
        <div class="section-title">Mortgage Information</div>
        <div class="form-row">
          <div class="form-group">
            <label>Mortgagee Name</label>
            <input type="text" id="mortgageeName" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Mortgagee Address Line 1</label>
            <input type="text" id="mortgageeAddressLine1" />
          </div>
          <div class="form-group">
            <label>Mortgagee Address Line 2</label>
            <input type="text" id="mortgageeAddressLine2" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>City</label>
            <input type="text" id="mortgageeCity" />
          </div>
          <div class="form-group">
            <label>State</label>
            <input type="text" id="mortgageeState" value="NC" />
          </div>
          <div class="form-group">
            <label>ZIP Code</label>
            <input type="text" id="mortgageeZipCode" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Loan Number</label>
            <input type="text" id="loanNumber" />
          </div>
        </div>
      </div>

      <!-- Attorney Information (for closing) -->
      <div class="form-section" id="attorneySection">
        <div class="section-title">Closing Attorney Information</div>
        <div class="form-row">
          <div class="form-group">
            <label>Attorney/Law Firm Name</label>
            <input type="text" id="attorneyName" />
          </div>
          <div class="form-group">
            <label>Email</label>
            <input type="email" id="attorneyEmail" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Address Line 1</label>
            <input type="text" id="attorneyAddressLine1" />
          </div>
          <div class="form-group">
            <label>Address Line 2</label>
            <input type="text" id="attorneyAddressLine2" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>City</label>
            <input type="text" id="attorneyCity" />
          </div>
          <div class="form-group">
            <label>State</label>
            <input type="text" id="attorneyState" value="NC" />
          </div>
          <div class="form-group">
            <label>ZIP Code</label>
            <input type="text" id="attorneyZipCode" />
          </div>
        </div>
      </div>

      <!-- Cancellation Specific Fields -->
      <div class="form-section" id="cancellationSection">
        <div class="section-title">Cancellation Details</div>
        <div class="form-row">
          <div class="form-group">
            <label>Cancellation Date</label>
            <input type="date" id="cancellationDate" />
          </div>
          <div class="form-group">
            <label>Cancellation Reason</label>
            <select id="cancellationReason">
              <option value="">Select Reason</option>
              <option value="nonpayment">Non-Payment</option>
              <option value="insured-request">Insured Request</option>
              <option value="underwriting">Underwriting Decision</option>
              <option value="sold">Property Sold</option>
              <option value="other">Other</option>
            </select>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group full-width">
            <label>Additional Notes</label>
            <textarea id="cancellationNotes" rows="3"></textarea>
          </div>
        </div>
      </div>

      <!-- Renewal Specific Fields -->
      <div class="form-section" id="renewalSection">
        <div class="section-title">Renewal Information</div>
        <div class="form-row">
          <div class="form-group">
            <label>Current Premium</label>
            <input type="number" id="currentPremium" min="0" step="0.01" />
          </div>
          <div class="form-group">
            <label>Renewal Premium</label>
            <input type="number" id="renewalPremium" min="0" step="0.01" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Renewal Date</label>
            <input type="date" id="renewalDate" />
          </div>
          <div class="form-group">
            <label>Payment Due Date</label>
            <input type="date" id="paymentDueDate" />
          </div>
        </div>
      </div>

      <!-- Coverage Change Fields -->
      <div class="form-section" id="coverageChangeSection">
        <div class="section-title">Coverage Change Details</div>
        <div class="form-row">
          <div class="form-group full-width">
            <label>Change Description</label>
            <textarea id="changeDescription" rows="3" placeholder="Describe the coverage changes..."></textarea>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Previous Premium</label>
            <input type="number" id="previousPremium" min="0" step="0.01" />
          </div>
          <div class="form-group">
            <label>New Premium</label>
            <input type="number" id="newPremium" min="0" step="0.01" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Change Effective Date</label>
            <input type="date" id="changeEffectiveDate" />
          </div>
        </div>
      </div>

      <!-- Payment Receipt Fields -->
      <div class="form-section" id="paymentSection">
        <div class="section-title">Payment Information</div>
        <div class="form-row">
          <div class="form-group">
            <label>Payment Amount</label>
            <input type="number" id="paymentAmount" min="0" step="0.01" />
          </div>
          <div class="form-group">
            <label>Payment Date</label>
            <input type="date" id="paymentDate" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Payment Method</label>
            <select id="paymentMethod">
              <option value="">Select Method</option>
              <option value="check">Check</option>
              <option value="cash">Cash</option>
              <option value="card">Credit/Debit Card</option>
              <option value="eft">Electronic Transfer</option>
              <option value="escrow">Escrow Payment</option>
            </select>
          </div>
          <div class="form-group">
            <label>Reference Number</label>
            <input type="text" id="referenceNumber" placeholder="Check # or Transaction ID" />
          </div>
        </div>
      </div>

      <!-- Claim Information Fields -->
      <div class="form-section" id="claimSection">
        <div class="section-title">Claim Contact Information</div>
        <div class="form-row">
          <div class="form-group">
            <label>Claim Phone Number</label>
            <input type="tel" id="claimPhone" />
          </div>
          <div class="form-group">
            <label>Claim Email</label>
            <input type="email" id="claimEmail" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group full-width">
            <label>Special Instructions</label>
            <textarea id="claimInstructions" placeholder="Enter any special claim filing instructions..."></textarea>
          </div>
        </div>
      </div>

      <!-- DL-123 Specific Fields -->
      <div class="form-section" id="dl123Section">
        <div class="section-title">DL-123 Driver Information</div>
        <div class="form-row">
          <div class="form-group">
            <label>Insured Driver Name</label>
            <input type="text" id="insuredDriverName" />
          </div>
          <div class="form-group">
            <label>Date of Birth</label>
            <input type="date" id="driverDateOfBirth" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Agency Code #</label>
            <input type="text" id="agencyCode" />
          </div>
          <div class="form-group">
            <label>Agent Signature Name</label>
            <input type="text" id="agentSignatureName" placeholder="Agent's printed name" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Date of Certification</label>
            <input type="date" id="certificationDate" />
          </div>
        </div>
      </div>

      <!-- Letterhead Specific Fields -->
      <div class="form-section" id="letterheadSection">
        <div class="section-title">Professional Letter Information</div>
        <div class="form-row">
          <div class="form-group">
            <label>Recipient Name</label>
            <input type="text" id="letterRecipientName" placeholder="John Doe" />
          </div>
          <div class="form-group">
            <label>Recipient Company (Optional)</label>
            <input type="text" id="letterRecipientCompany" placeholder="ABC Corporation" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Recipient Address</label>
            <input type="text" id="letterRecipientAddress" placeholder="123 Main Street" />
          </div>
          <div class="form-group">
            <label>City, State ZIP</label>
            <input type="text" id="letterRecipientCityStateZip" placeholder="New York, NY 10001" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Letter Date</label>
            <input type="date" id="letterDate" />
          </div>
          <div class="form-group">
            <label>Letter Subject</label>
            <input type="text" id="letterSubject" placeholder="RE: Insurance Policy Update" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Sender Name</label>
            <input type="text" id="letterSenderName" placeholder="Jane Smith" />
          </div>
          <div class="form-group">
            <label>Sender Position</label>
            <input type="text" id="letterSenderPosition" placeholder="Insurance Agent" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group full-width">
            <label>Letter Content</label>
            <textarea id="letterContent" rows="8" placeholder="Dear [Recipient],

Thank you for your interest in our insurance services. I am writing to provide you with important information regarding your policy...

Please feel free to contact me if you have any questions or need additional information."></textarea>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Closing</label>
            <select id="letterClosing">
              <option value="Sincerely">Sincerely</option>
              <option value="Best Regards">Best Regards</option>
              <option value="Respectfully">Respectfully</option>
              <option value="Thank you">Thank you</option>
              <option value="Cordially">Cordially</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Envelope Specific Fields -->
      <div class="form-section" id="envelopeSection">
        <div class="section-title">Envelope Information</div>
        <div class="form-row">
          <div class="form-group">
            <label>Envelope Size</label>
            <select id="envelopeSize">
              <option value="10">#10 Standard (9.5" √ó 4.125")</option>
              <option value="9">#9 Business (8.875" √ó 3.875")</option>
              <option value="a7">A7 Announcement (7.25" √ó 5.25")</option>
            </select>
          </div>
          <div class="form-group">
            <label>Include Return Address</label>
            <select id="envelopeIncludeReturn">
              <option value="yes">Yes</option>
              <option value="no">No</option>
            </select>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group full-width">
            <label>Recipient Address</label>
            <textarea id="envelopeRecipientAddress" rows="4" placeholder="John Doe
123 Main Street
New York, NY 10001"></textarea>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group full-width">
            <label>Return Address (Optional - Leave blank to use default)</label>
            <textarea id="envelopeReturnAddress" rows="3" placeholder="Bill Layne Insurance
PO Box 827
Elkin, NC 28621"></textarea>
          </div>
        </div>
      </div>

      <!-- Underwriting Document Fields -->
      <div class="form-section" id="underwritingSection">
        <div class="section-title">Underwriting Information Request</div>
        <div class="form-row">
          <div class="form-group">
            <label>Insurance Company</label>
            <select id="underwritingCompany">
              <option value="">Select Company</option>
              <option value="Nationwide">Nationwide</option>
              <option value="Progressive">Progressive</option>
              <option value="National General">National General</option>
              <option value="Travelers">Travelers</option>
              <option value="NC Grange Mutual">NC Grange Mutual</option>
              <option value="Alamance">Alamance</option>
              <option value="Universal Property">Universal Property</option>
              <option value="Other">Other</option>
            </select>
          </div>
          <div class="form-group">
            <label>Underwriter Email</label>
            <input type="email" id="underwriterEmail" placeholder="underwriter@insurance.com" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Subject Line</label>
            <input type="text" id="underwritingSubject" placeholder="Underwriting Request - Policy #123456" />
          </div>
          <div class="form-group">
            <label>Policy/Quote Number</label>
            <input type="text" id="underwritingPolicyNumber" placeholder="Enter policy or quote number" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Insured Name</label>
            <input type="text" id="underwritingInsuredName" placeholder="John and Jane Doe" />
          </div>
          <div class="form-group">
            <label>Property Address</label>
            <input type="text" id="underwritingPropertyAddress" placeholder="123 Main St, Elkin, NC 28621" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Request Type</label>
            <select id="underwritingRequestType" onchange="updateUnderwritingTemplate()">
              <option value="new">New Business Quote</option>
              <option value="renewal">Renewal</option>
              <option value="endorsement">Endorsement/Change</option>
              <option value="inspection">Inspection Photos</option>
              <option value="claims">Claims History</option>
              <option value="documentation">Additional Documentation</option>
              <option value="custom">Custom Request</option>
            </select>
          </div>
          <div class="form-group">
            <label>Priority Level</label>
            <select id="underwritingPriority">
              <option value="normal">Normal</option>
              <option value="urgent">Urgent - Closing/Time Sensitive</option>
              <option value="high">High Priority</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group full-width">
            <label>Documents/Information Needed</label>
            <textarea id="underwritingDocumentsNeeded" rows="4" placeholder="Please provide:
- 4-point inspection report
- Wind mitigation form
- Photos of roof (all sides)
- Proof of roof replacement"></textarea>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group full-width">
            <label>Additional Notes/Context</label>
            <textarea id="underwritingNotes" rows="3" placeholder="Any additional information or special circumstances..."></textarea>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Response Needed By</label>
            <input type="date" id="underwritingDeadline" />
          </div>
          <div class="form-group">
            <label>Agent Name</label>
            <input type="text" id="underwritingAgentName" placeholder="Your name" value="Bill Layne" />
          </div>
        </div>
      </div>

      <!-- Auto ID Card Specific Fields -->
      <div class="form-section" id="autoIDCardSection">
        <div class="section-title">Auto Insurance ID Card Information</div>
        <div class="form-row">
          <div class="form-group">
            <label>Insurance Company</label>
            <select id="idCardCompany" onchange="updateIDCardCompanyInfo()">
              <option value="">Select Company</option>
              <option value="Nationwide">Nationwide</option>
              <option value="Progressive">Progressive</option>
              <option value="National General">National General</option>
              <option value="Travelers">Travelers</option>
              <option value="NC Grange Mutual">NC Grange Mutual</option>
              <option value="Alamance">Alamance</option>
              <option value="Universal Property">Universal Property</option>
              <option value="Dairyland">Dairyland</option>
            </select>
          </div>
          <div class="form-group">
            <label>Number of Vehicles</label>
            <select id="idCardVehicleCount" onchange="updateVehicleFields()">
              <option value="1">1 Vehicle</option>
              <option value="2">2 Vehicles</option>
              <option value="3">3 Vehicles</option>
              <option value="4">4 Vehicles</option>
            </select>
          </div>
        </div>
        
        <!-- Vehicle 1 Information -->
        <div id="vehicle1Section">
          <h4 style="color: #004080; margin-top: 20px;">Vehicle 1 Information</h4>
          <div class="form-row">
            <div class="form-group">
              <label>Year</label>
              <input type="text" id="vehicle1Year" placeholder="2024" />
            </div>
            <div class="form-group">
              <label>Make</label>
              <input type="text" id="vehicle1Make" placeholder="Honda" />
            </div>
            <div class="form-group">
              <label>Model</label>
              <input type="text" id="vehicle1Model" placeholder="Accord" />
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>VIN</label>
              <input type="text" id="vehicle1VIN" placeholder="Vehicle Identification Number" />
            </div>
          </div>
        </div>

        <!-- Vehicle 2 Information (Hidden by default) -->
        <div id="vehicle2Section" style="display: none;">
          <h4 style="color: #004080; margin-top: 20px;">Vehicle 2 Information</h4>
          <div class="form-row">
            <div class="form-group">
              <label>Year</label>
              <input type="text" id="vehicle2Year" placeholder="2024" />
            </div>
            <div class="form-group">
              <label>Make</label>
              <input type="text" id="vehicle2Make" placeholder="Toyota" />
            </div>
            <div class="form-group">
              <label>Model</label>
              <input type="text" id="vehicle2Model" placeholder="Camry" />
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>VIN</label>
              <input type="text" id="vehicle2VIN" placeholder="Vehicle Identification Number" />
            </div>
          </div>
        </div>

        <!-- Vehicle 3 Information (Hidden by default) -->
        <div id="vehicle3Section" style="display: none;">
          <h4 style="color: #004080; margin-top: 20px;">Vehicle 3 Information</h4>
          <div class="form-row">
            <div class="form-group">
              <label>Year</label>
              <input type="text" id="vehicle3Year" placeholder="2024" />
            </div>
            <div class="form-group">
              <label>Make</label>
              <input type="text" id="vehicle3Make" placeholder="Ford" />
            </div>
            <div class="form-group">
              <label>Model</label>
              <input type="text" id="vehicle3Model" placeholder="F-150" />
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>VIN</label>
              <input type="text" id="vehicle3VIN" placeholder="Vehicle Identification Number" />
            </div>
          </div>
        </div>

        <!-- Vehicle 4 Information (Hidden by default) -->
        <div id="vehicle4Section" style="display: none;">
          <h4 style="color: #004080; margin-top: 20px;">Vehicle 4 Information</h4>
          <div class="form-row">
            <div class="form-group">
              <label>Year</label>
              <input type="text" id="vehicle4Year" placeholder="2024" />
            </div>
            <div class="form-group">
              <label>Make</label>
              <input type="text" id="vehicle4Make" placeholder="Chevrolet" />
            </div>
            <div class="form-group">
              <label>Model</label>
              <input type="text" id="vehicle4Model" placeholder="Silverado" />
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>VIN</label>
              <input type="text" id="vehicle4VIN" placeholder="Vehicle Identification Number" />
            </div>
          </div>
        </div>

        <!-- Driver Information -->
        <div class="form-row" style="margin-top: 20px;">
          <div class="form-group">
            <label>Primary Driver Name</label>
            <input type="text" id="idCardDriverName" placeholder="John Doe" />
          </div>
          <div class="form-group">
            <label>Additional Driver (Optional)</label>
            <input type="text" id="idCardAdditionalDriver" placeholder="Jane Doe" />
          </div>
        </div>

        <!-- Policy Information for ID Card -->
        <div class="form-row">
          <div class="form-group">
            <label>Policy Number</label>
            <input type="text" id="idCardPolicyNumber" placeholder="Enter Policy Number" />
          </div>
          <div class="form-group">
            <label>NAIC #</label>
            <input type="text" id="idCardNAIC" placeholder="Auto-filled based on company" readonly style="background-color: #f0f0f0;" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Effective Date</label>
            <input type="date" id="idCardEffectiveDate" />
          </div>
          <div class="form-group">
            <label>Expiration Date</label>
            <input type="date" id="idCardExpirationDate" />
          </div>
        </div>
      </div>

      <div class="button-group">
        <button type="button" onclick="generateDocuments()">Generate Documents</button>
      </div>

      <!-- Preview Section -->
      <div id="previewSection" style="display: none;">
        <h2>Generated Documents</h2>
        <div id="documentPreviewContainer"></div>
      </div>
    </div>
  </div>

  <!-- PDF Templates Tab -->
  <div id="templates-tab" class="tab-content" style="display: none;">
    <div class="pdf-templates-container">
      <h2>PDF Template Library</h2>
      <p style="margin-bottom: 20px;">Browse and download commonly used insurance forms and templates.</p>
      <div class="pdf-category-selector">
        <label for="pdfCategory">Filter by Category:</label>
        <select id="pdfCategory" onchange="loadPDFCategory()">
          <option value="all">All Templates</option>
          <option value="acord">ACORD Forms</option>
          <option value="state">State Forms</option>
          <option value="company">Company Forms</option>
        </select>
      </div>
      <div id="pdfGrid" class="pdf-grid">
        <!-- PDF cards will be dynamically loaded here -->
      </div>
    </div>
  </div>

  <!-- Resources Tab -->
  <div id="resources-tab" class="tab-content" style="display: none;">
    <div class="resources-container">
      <h2>Quick Links & Resources</h2>
      <div class="resource-grid">
        <div class="resource-card">
          <h4>üìû Contact Information</h4>
          <p><strong>Bill Layne Insurance Agency</strong><br>
          1283 N Bridge St<br>
          Elkin, NC 28621<br>
          Phone: (336) 835-1993<br>
          Email: Save@BillLayneInsurance.com</p>
        </div>
        
        <div class="resource-card">
          <h4>üè¢ Insurance Companies</h4>
          <p>Quick links to carrier websites:</p>
          <ul style="list-style: none; padding: 0;">
            <li><a href="https://www.nationwide.com" target="_blank">Nationwide</a></li>
            <li><a href="https://www.progressive.com" target="_blank">Progressive</a></li>
            <li><a href="https://www.travelers.com" target="_blank">Travelers</a></li>
            <li><a href="https://www.nationalgeneral.com" target="_blank">National General</a></li>
          </ul>
        </div>
        
        <div class="resource-card">
          <h4>üìã NC DMV Resources</h4>
          <p>North Carolina DMV forms and information:</p>
          <ul style="list-style: none; padding: 0;">
            <li><a href="https://www.ncdot.gov/dmv" target="_blank">NC DMV Website</a></li>
            <li><a href="https://www.ncdot.gov/dmv/insurance" target="_blank">Insurance Requirements</a></li>
            <li><a href="https://www.ncdot.gov/dmv/forms" target="_blank">DMV Forms</a></li>
            <li><a href="https://vehicle-search.ncshp.org/accidents" target="_blank">NC Highway Patrol Crash Reports</a></li>
            <li><a href="https://payments.ncdot.gov/" target="_blank">Pay DMV Fines</a></li>
          </ul>
        </div>
        
        <div class="resource-card">
          <h4>üìß Company Email Addresses</h4>
          <p>Important email contacts for submissions:</p>
          <ul style="list-style: none; padding: 0;">
            <li><strong>NC Grange Underwriting:</strong><br>
                <a href="mailto:data4apps@ncgm.com">data4apps@ncgm.com</a></li>
            <li style="margin-top: 10px;"><strong>Progressive Uploads:</strong><br>
                <a href="mailto:upload@progressiveagent.com">upload@progressiveagent.com</a></li>
          </ul>
        </div>
        
        <div class="resource-card">
          <h4>üîß Tools & Calculators</h4>
          <p>Helpful insurance tools:</p>
          <ul style="list-style: none; padding: 0;">
            <li><a href="https://billlayne.github.io/coi-generator/" target="_blank">Certificate Maker</a></li>
            <li><a href="#" onclick="alert('Coming soon!')">Premium Calculator</a></li>
            <li><a href="#" onclick="alert('Coming soon!')">Coverage Estimator</a></li>
            <li><a href="#" onclick="alert('Coming soon!')">Deductible Comparison</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Prompt Manager Tab -->
  <div id="prompts-tab" class="tab-content" style="display: none;">
    <style>
      .prompts-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }
      
      .prompts-header {
        background: white;
        border-radius: 12px;
        padding: 30px;
        margin-bottom: 30px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        text-align: center;
      }
      
      .prompts-toolbar {
        background: white;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        display: flex;
        gap: 15px;
        flex-wrap: wrap;
        align-items: center;
      }
      
      .prompt-btn {
        background: #667eea;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s;
        font-weight: 500;
      }
      
      .prompt-btn:hover {
        background: #5a67d8;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
      }
      
      .prompt-btn.secondary {
        background: #48bb78;
      }
      
      .prompt-btn.secondary:hover {
        background: #38a169;
      }
      
      .prompt-search-box {
        flex: 1;
        min-width: 200px;
      }
      
      .prompt-search-box input {
        width: 100%;
        padding: 12px;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        font-size: 1rem;
      }
      
      .prompt-filter-bar {
        background: white;
        border-radius: 12px;
        padding: 15px 20px;
        margin-bottom: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        display: flex;
        gap: 15px;
        align-items: center;
        flex-wrap: wrap;
      }
      
      .prompt-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }
      
      .prompt-card {
        background: white;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        transition: all 0.3s;
        position: relative;
      }
      
      .prompt-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 16px rgba(0,0,0,0.15);
      }
      
      .favorite-btn {
        position: absolute;
        top: 15px;
        right: 15px;
        background: none;
        border: none;
        font-size: 1.5rem;
        cursor: pointer;
        transition: transform 0.2s;
      }
      
      .favorite-btn:hover {
        transform: scale(1.2);
      }
      
      .favorite-btn.active {
        color: #f6ad55;
      }
      
      .prompt-title {
        font-size: 1.2rem;
        font-weight: bold;
        color: #333;
        margin-bottom: 10px;
        padding-right: 40px;
      }
      
      .prompt-content {
        color: #666;
        margin-bottom: 15px;
        line-height: 1.5;
        max-height: 100px;
        overflow: hidden;
      }
      
      .prompt-card-actions {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }
      
      .card-btn {
        padding: 8px 16px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 0.9rem;
        transition: all 0.2s;
      }
      
      .copy-btn {
        background: #667eea;
        color: white;
      }
      
      .copy-btn:hover {
        background: #5a67d8;
      }
      
      .edit-btn {
        background: #4299e1;
        color: white;
      }
      
      .edit-btn:hover {
        background: #3182ce;
      }
      
      .delete-btn {
        background: #f56565;
        color: white;
      }
      
      .delete-btn:hover {
        background: #e53e3e;
      }
      
      .prompt-empty-state {
        text-align: center;
        padding: 60px 20px;
        background: white;
        border-radius: 12px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }
      
      .prompt-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0,0,0,0.5);
        z-index: 1000;
        padding: 20px;
      }
      
      .prompt-modal.active {
        display: flex;
        align-items: center;
        justify-content: center;
      }
      
      .prompt-modal-content {
        background: white;
        border-radius: 12px;
        width: 100%;
        max-width: 600px;
        max-height: 90vh;
        overflow-y: auto;
      }
      
      .prompt-modal-header {
        padding: 20px;
        border-bottom: 1px solid #e2e8f0;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      
      .prompt-modal-close {
        background: none;
        border: none;
        font-size: 1.5rem;
        cursor: pointer;
        color: #666;
      }
      
      .prompt-modal-body {
        padding: 20px;
      }
      
      .prompt-form-group {
        margin-bottom: 20px;
      }
      
      .prompt-form-group label {
        display: block;
        margin-bottom: 8px;
        color: #333;
        font-weight: 500;
      }
      
      .prompt-form-group input,
      .prompt-form-group textarea {
        width: 100%;
        padding: 10px;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        font-size: 1rem;
      }
      
      .prompt-form-group textarea {
        min-height: 150px;
        resize: vertical;
        font-family: inherit;
      }
      
      .prompt-modal-footer {
        padding: 20px;
        border-top: 1px solid #e2e8f0;
        display: flex;
        justify-content: flex-end;
        gap: 10px;
      }
      
      .prompt-toast {
        position: fixed;
        bottom: 30px;
        right: 30px;
        background: #48bb78;
        color: white;
        padding: 16px 24px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        display: none;
        animation: slideInPrompt 0.3s ease;
        z-index: 1001;
      }
      
      .prompt-toast.show {
        display: block;
      }
      
      .prompt-toast.error {
        background: #f56565;
      }
      
      @keyframes slideInPrompt {
        from {
          transform: translateX(100%);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }
    </style>
    
    <div class="prompts-container">
      <!-- Header -->
      <div class="prompts-header">
        <h1>üìù Prompt Manager</h1>
        <p>Save and organize your AI prompts in one place</p>
      </div>
      
      <!-- Toolbar -->
      <div class="prompts-toolbar">
        <button class="prompt-btn" onclick="openAddPromptModal()">‚ûï Add New Prompt</button>
        <button class="prompt-btn secondary" onclick="exportPrompts()">üì• Download All</button>
        <button class="prompt-btn secondary" onclick="document.getElementById('importPromptFile').click()">üì§ Upload Prompts</button>
        <input type="file" id="importPromptFile" accept=".json" style="display: none;" onchange="importPrompts(event)">
        <div class="prompt-search-box">
          <input type="text" id="promptSearchInput" placeholder="üîç Search prompts..." oninput="renderPrompts()">
        </div>
      </div>
      
      <!-- Filter Bar -->
      <div class="prompt-filter-bar">
        <label>Sort by:</label>
        <select id="promptSortSelect" onchange="renderPrompts()">
          <option value="alphabetical">A-Z (Title)</option>
          <option value="newest">Newest First</option>
          <option value="category">Category</option>
        </select>
        
        <label class="checkbox-label">
          <input type="checkbox" id="promptFavoritesOnly" onchange="renderPrompts()">
          Show Favorites Only
        </label>
      </div>
      
      <!-- Prompts Container -->
      <div id="promptsContainer"></div>
      
      <!-- Empty State -->
      <div class="prompt-empty-state" id="promptEmptyState" style="display: none;">
        <h3>No prompts yet</h3>
        <p>Click "Add New Prompt" to get started!</p>
      </div>
    </div>
    
    <!-- Add/Edit Modal -->
    <div class="prompt-modal" id="promptModal">
      <div class="prompt-modal-content">
        <div class="prompt-modal-header">
          <h2 id="promptModalTitle">Add New Prompt</h2>
          <button class="prompt-modal-close" onclick="closePromptModal()">‚úï</button>
        </div>
        <div class="prompt-modal-body">
          <div class="prompt-form-group">
            <label>Prompt Title *</label>
            <input type="text" id="promptTitleInput" placeholder="Give your prompt a name...">
          </div>
          <div class="prompt-form-group">
            <label>Prompt Content *</label>
            <textarea id="promptContentInput" placeholder="Enter your prompt here..."></textarea>
          </div>
          <div class="prompt-form-group">
            <label>Category (optional)</label>
            <input type="text" id="promptCategoryInput" placeholder="e.g., Email, Social Media, Reports">
          </div>
        </div>
        <div class="prompt-modal-footer">
          <button class="prompt-btn" onclick="closePromptModal()">Cancel</button>
          <button class="prompt-btn" onclick="savePrompt()">Save Prompt</button>
        </div>
      </div>
    </div>
    
    <!-- Toast Notification -->
    <div class="prompt-toast" id="promptToast"></div>
    
    <script>
      // Prompt Manager Data and Functions
      let prompts = [];
      let currentEditPromptId = null;
      
      // Load prompts from localStorage
      function loadPromptsFromStorage() {
        try {
          const stored = localStorage.getItem('simplePrompts');
          if (stored) {
            prompts = JSON.parse(stored);
            console.log(`Loaded ${prompts.length} prompts from localStorage`);
          } else {
            prompts = [];
            console.log('No prompts found in localStorage, starting fresh');
          }
        } catch (error) {
          console.error('Error loading prompts from localStorage:', error);
          prompts = [];
        }
      }
      
      // Save prompts to localStorage
      function savePromptsToStorage() {
        try {
          localStorage.setItem('simplePrompts', JSON.stringify(prompts));
          console.log(`Saved ${prompts.length} prompts to localStorage`);
        } catch (error) {
          console.error('Error saving prompts to localStorage:', error);
          showPromptToast('Failed to save prompts locally', true);
        }
      }
      
      // Initialize prompts when tab is shown
      function initializePrompts() {
        loadPromptsFromStorage();
        renderPrompts();
      }
      
      // Load prompts on page load
      loadPromptsFromStorage();
      
      function renderPrompts() {
        const container = document.getElementById('promptsContainer');
        const emptyState = document.getElementById('promptEmptyState');
        const searchTerm = document.getElementById('promptSearchInput').value.toLowerCase();
        const sortBy = document.getElementById('promptSortSelect').value;
        const favoritesOnly = document.getElementById('promptFavoritesOnly').checked;
        
        // Filter prompts
        let filtered = prompts.filter(p => {
          const matchesSearch = p.title.toLowerCase().includes(searchTerm) || 
            p.content.toLowerCase().includes(searchTerm) ||
            (p.category || '').toLowerCase().includes(searchTerm);
          const matchesFavorite = !favoritesOnly || p.isFavorite;
          return matchesSearch && matchesFavorite;
        });
        
        // Sort prompts
        filtered.sort((a, b) => {
          if (sortBy === 'alphabetical') {
            return a.title.localeCompare(b.title);
          } else if (sortBy === 'newest') {
            return new Date(b.createdAt) - new Date(a.createdAt);
          } else if (sortBy === 'category') {
            const catA = a.category || 'zzz';
            const catB = b.category || 'zzz';
            if (catA === catB) {
              return a.title.localeCompare(b.title);
            }
            return catA.localeCompare(catB);
          }
          return 0;
        });
        
        if (filtered.length === 0) {
          container.innerHTML = '';
          emptyState.style.display = 'block';
          if (favoritesOnly) {
            emptyState.querySelector('h3').textContent = 'No favorite prompts yet';
            emptyState.querySelector('p').textContent = 'Star some prompts to see them here!';
          } else if (searchTerm) {
            emptyState.querySelector('h3').textContent = 'No prompts found';
            emptyState.querySelector('p').textContent = 'Try a different search term';
          } else {
            emptyState.querySelector('h3').textContent = 'No prompts yet';
            emptyState.querySelector('p').textContent = 'Click "Add New Prompt" to get started!';
          }
          return;
        }
        
        emptyState.style.display = 'none';
        
        container.innerHTML = '<div class="prompt-grid">' + 
          filtered.map(prompt => `
            <div class="prompt-card">
              <button class="favorite-btn ${prompt.isFavorite ? 'active' : ''}" onclick="togglePromptFavorite('${prompt.id}')">
                ${prompt.isFavorite ? '‚≠ê' : '‚òÜ'}
              </button>
              <div class="prompt-title">${escapeHtmlPrompt(prompt.title)}</div>
              ${prompt.category ? `<div style="color: #667eea; font-size: 0.9rem; margin-bottom: 10px;">üìÅ ${escapeHtmlPrompt(prompt.category)}</div>` : ''}
              <div class="prompt-content">${escapeHtmlPrompt(prompt.content)}</div>
              <div class="prompt-card-actions">
                <button class="card-btn copy-btn" onclick="copyPrompt('${prompt.id}')">üìã Copy</button>
                <button class="card-btn edit-btn" onclick="editPrompt('${prompt.id}')">‚úèÔ∏è Edit</button>
                <button class="card-btn delete-btn" onclick="deletePrompt('${prompt.id}')">üóëÔ∏è Delete</button>
              </div>
            </div>
          `).join('') + '</div>';
      }
      
      function togglePromptFavorite(id) {
        const prompt = prompts.find(p => p.id === id);
        if (!prompt) return;
        
        prompt.isFavorite = !prompt.isFavorite;
        savePromptsToStorage();
        renderPrompts();
        showPromptToast(prompt.isFavorite ? 'Added to favorites!' : 'Removed from favorites');
      }
      
      function openAddPromptModal() {
        document.getElementById('promptModalTitle').textContent = 'Add New Prompt';
        document.getElementById('promptTitleInput').value = '';
        document.getElementById('promptContentInput').value = '';
        document.getElementById('promptCategoryInput').value = '';
        currentEditPromptId = null;
        document.getElementById('promptModal').classList.add('active');
      }
      
      function editPrompt(id) {
        const prompt = prompts.find(p => p.id === id);
        if (!prompt) return;
        
        document.getElementById('promptModalTitle').textContent = 'Edit Prompt';
        document.getElementById('promptTitleInput').value = prompt.title;
        document.getElementById('promptContentInput').value = prompt.content;
        document.getElementById('promptCategoryInput').value = prompt.category || '';
        currentEditPromptId = id;
        document.getElementById('promptModal').classList.add('active');
      }
      
      function closePromptModal() {
        document.getElementById('promptModal').classList.remove('active');
      }
      
      function savePrompt() {
        const title = document.getElementById('promptTitleInput').value.trim();
        const content = document.getElementById('promptContentInput').value.trim();
        const category = document.getElementById('promptCategoryInput').value.trim();
        
        if (!title || !content) {
          showPromptToast('Please fill in all required fields', true);
          return;
        }
        
        if (currentEditPromptId) {
          // Edit existing
          const index = prompts.findIndex(p => p.id === currentEditPromptId);
          prompts[index] = { ...prompts[index], title, content, category };
          showPromptToast('Prompt updated successfully!');
        } else {
          // Add new
          const newPrompt = {
            id: Date.now().toString(),
            title,
            content,
            category,
            isFavorite: false,
            createdAt: new Date().toISOString()
          };
          prompts.unshift(newPrompt);
          showPromptToast('Prompt added successfully!');
        }
        
        savePromptsToStorage();
        renderPrompts();
        closePromptModal();
      }
      
      function copyPrompt(id) {
        const prompt = prompts.find(p => p.id === id);
        if (!prompt) return;
        
        navigator.clipboard.writeText(prompt.content).then(() => {
          showPromptToast('Prompt copied to clipboard!');
        }).catch(() => {
          showPromptToast('Failed to copy', true);
        });
      }
      
      function deletePrompt(id) {
        if (!confirm('Are you sure you want to delete this prompt?')) return;
        
        prompts = prompts.filter(p => p.id !== id);
        savePromptsToStorage();
        renderPrompts();
        showPromptToast('Prompt deleted');
      }
      
      function exportPrompts() {
        const dataStr = JSON.stringify(prompts, null, 2);
        const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
        const link = document.createElement('a');
        link.href = dataUri;
        link.download = `prompts-backup-${new Date().toISOString().split('T')[0]}.json`;
        link.click();
        showPromptToast('Prompts downloaded!');
      }
      
      function importPrompts(event) {
        const file = event.target.files[0];
        if (!file) return;
        
        const reader = new FileReader();
        reader.onload = function(e) {
          try {
            const imported = JSON.parse(e.target.result);
            if (Array.isArray(imported)) {
              imported.forEach(p => {
                if (p.isFavorite === undefined) p.isFavorite = false;
              });
              prompts = [...imported, ...prompts];
              savePromptsToStorage();
              renderPrompts();
              showPromptToast(`Imported ${imported.length} prompts!`);
            }
          } catch (err) {
            showPromptToast('Invalid file format', true);
          }
        };
        reader.readAsText(file);
        event.target.value = '';
      }
      
      function showPromptToast(message, isError = false) {
        const toast = document.getElementById('promptToast');
        toast.textContent = message;
        toast.className = 'prompt-toast show' + (isError ? ' error' : '');
        setTimeout(() => {
          toast.classList.remove('show');
        }, 3000);
      }
      
      function escapeHtmlPrompt(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
      }
      
      // Close modal on Escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && document.getElementById('promptModal').classList.contains('active')) {
          closePromptModal();
        }
      });
      
      // Auto-save prompts before page unload
      window.addEventListener('beforeunload', () => {
        if (prompts.length > 0) {
          savePromptsToStorage();
        }
      });
      
      // Verify localStorage is working
      window.addEventListener('DOMContentLoaded', () => {
        // Test localStorage availability
        try {
          const testKey = '__localStorageTest__';
          localStorage.setItem(testKey, 'test');
          localStorage.removeItem(testKey);
          console.log('‚úÖ localStorage is available and working');
        } catch (e) {
          console.error('‚ùå localStorage is not available:', e);
          showPromptToast('Warning: Cannot save prompts locally. Your browser may have storage disabled.', true);
        }
      });
    </script>
  </div>

  <!-- SNL Tab (Statement of No Loss Generator) -->
  <div id="snl-tab" class="tab-content" style="display: none;">
    <style>
      .snl-container {
        max-width: 700px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        overflow: hidden;
      }
      
      .snl-header {
        background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
        color: white;
        padding: 25px 20px;
        text-align: center;
      }
      
      .snl-header h1 {
        font-size: 24px;
        margin-bottom: 10px;
      }
      
      .snl-header p {
        font-size: 14px;
        opacity: 0.9;
      }
      
      .snl-system-badge {
        display: inline-block;
        background: #FF9800;
        color: white;
        padding: 5px 15px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: bold;
        margin-top: 10px;
      }
      
      .snl-form-container {
        padding: 25px 20px;
      }
      
      .snl-section-title {
        background: #f8f9fa;
        padding: 10px 15px;
        margin: 20px -20px 15px -20px;
        border-left: 4px solid #667eea;
        font-weight: 600;
        color: #2a5298;
      }
      
      .snl-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin-bottom: 15px;
      }
      
      .snl-form-group {
        margin-bottom: 15px;
      }
      
      .snl-form-group.full-width {
        grid-column: span 2;
      }
      
      .snl-form-group label {
        display: block;
        font-weight: 600;
        color: #333;
        margin-bottom: 5px;
        font-size: 14px;
      }
      
      .snl-required {
        color: #f44336;
      }
      
      .snl-form-group input[type="text"],
      .snl-form-group input[type="email"],
      .snl-form-group input[type="tel"],
      .snl-form-group input[type="date"],
      .snl-form-group select {
        width: 100%;
        padding: 10px 12px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        font-size: 15px;
        transition: all 0.3s;
      }
      
      .snl-form-group input:focus,
      .snl-form-group select:focus {
        outline: none;
        border-color: #667eea;
        background: #f8f9ff;
      }
      
      .snl-button-group {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-top: 25px;
      }
      
      .snl-btn {
        padding: 12px 20px;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
      }
      
      .snl-btn-generate {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        grid-column: span 2;
      }
      
      .snl-btn-generate:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
      }
      
      .snl-btn-copy {
        background: #4CAF50;
        color: white;
      }
      
      .snl-btn-copy:hover {
        background: #45a049;
      }
      
      .snl-btn-email {
        background: #2196F3;
        color: white;
      }
      
      .snl-btn-email:hover {
        background: #0b7dda;
      }
      
      .snl-btn-text {
        background: #FF9800;
        color: white;
      }
      
      .snl-btn-text:hover {
        background: #e68900;
      }
      
      .snl-btn-clear {
        background: #f44336;
        color: white;
      }
      
      .snl-btn-clear:hover {
        background: #da190b;
      }
      
      .snl-btn-matrix {
        background: #2196F3;
        color: white;
      }
      
      .snl-btn-matrix:hover {
        background: #0b7dda;
      }
      
      .snl-btn-open {
        background: #9C27B0;
        color: white;
      }
      
      .snl-btn-open:hover {
        background: #7B1FA2;
      }
      
      .snl-result-section {
        display: none;
        margin-top: 25px;
        padding: 20px;
        background: #f0f4ff;
        border-radius: 10px;
        border: 2px solid #667eea;
      }
      
      .snl-result-section h3 {
        color: #2a5298;
        margin-bottom: 15px;
        font-size: 18px;
      }
      
      .snl-link-display {
        background: white;
        padding: 15px;
        border-radius: 8px;
        word-break: break-all;
        font-family: monospace;
        font-size: 13px;
        color: #333;
        border: 1px solid #ddd;
        margin-bottom: 15px;
        user-select: all;
      }
      
      .snl-message-templates {
        margin-top: 20px;
        padding: 15px;
        background: white;
        border-radius: 8px;
      }
      
      .snl-template {
        margin-bottom: 15px;
        padding: 12px;
        background: #f8f9fa;
        border-radius: 6px;
        border-left: 3px solid #667eea;
      }
      
      .snl-template h4 {
        color: #2a5298;
        font-size: 14px;
        margin-bottom: 8px;
      }
      
      .snl-template-text {
        font-size: 13px;
        line-height: 1.5;
        color: #555;
        white-space: pre-wrap;
      }
      
      .snl-copy-status {
        display: none;
        color: #4CAF50;
        font-weight: 600;
        text-align: center;
        margin-top: 10px;
      }
      
      .snl-instructions {
        background: #fff3cd;
        border: 1px solid #ffc107;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 20px;
      }
      
      .snl-instructions h4 {
        color: #856404;
        margin-bottom: 8px;
      }
      
      .snl-instructions ol {
        margin-left: 20px;
        color: #856404;
        font-size: 14px;
      }
      
      .snl-instructions li {
        margin-bottom: 5px;
      }
      
      .snl-email-notice {
        color: #d9534f; 
        font-weight: bold;
      }
      
      @media (max-width: 600px) {
        .snl-row {
          grid-template-columns: 1fr;
        }
        
        .snl-form-group.full-width {
          grid-column: span 1;
        }
        
        .snl-button-group {
          grid-template-columns: 1fr;
        }
        
        .snl-btn-generate {
          grid-column: span 1;
        }
        
        .snl-header h1 {
          font-size: 20px;
        }
      }
    </style>
    
    <div class="snl-container">
      <div class="snl-header">
        <h1>üìã No Loss Statement Link Generator</h1>
        <p>Bill Layne Insurance Agency - Staff Tool</p>
        <span class="snl-system-badge">DOCS EMAIL SYSTEM</span>
      </div>
      
      <div class="snl-form-container">
        <div class="snl-instructions">
          <h4>üìå Quick Instructions:</h4>
          <ol>
            <li>Fill in customer's information below</li>
            <li>Click "Generate Link"</li>
            <li>Copy the link or use email/text templates</li>
            <li>Send to customer - they just need to sign!</li>
            <li class="snl-email-notice">‚ö†Ô∏è This sends to Docs@BillLayneInsurance.com</li>
          </ol>
        </div>
        
        <form id="snlLinkGenerator">
          <div class="snl-section-title">Customer Information</div>
          
          <div class="snl-row">
            <div class="snl-form-group full-width">
              <label for="snlCustomerName">Customer Name <span class="snl-required">*</span></label>
              <input type="text" id="snlCustomerName" required placeholder="John Smith">
            </div>
          </div>
          
          <div class="snl-row">
            <div class="snl-form-group">
              <label for="snlEmail">Email Address</label>
              <input type="email" id="snlEmail" placeholder="customer@email.com">
            </div>
            
            <div class="snl-form-group">
              <label for="snlPhone">Phone Number</label>
              <input type="tel" id="snlPhone" placeholder="(336) 555-1234">
            </div>
          </div>
          
          <div class="snl-section-title">Policy Information</div>
          
          <div class="snl-row">
            <div class="snl-form-group">
              <label for="snlPolicyNumber">Policy Number <span class="snl-required">*</span></label>
              <input type="text" id="snlPolicyNumber" required placeholder="ABC123456">
            </div>
            
            <div class="snl-form-group">
              <label for="snlInsuranceCompany">Insurance Company <span class="snl-required">*</span></label>
              <select id="snlInsuranceCompany" required>
                <option value="">Select Company</option>
                <option value="Nationwide">Nationwide</option>
                <option value="Progressive">Progressive</option>
                <option value="National General">National General</option>
                <option value="Alamance">Alamance</option>
                <option value="Travelers">Travelers</option>
                <option value="Foremost">Foremost</option>
                <option value="Other">Other</option>
              </select>
            </div>
          </div>
          
          <div class="snl-row">
            <div class="snl-form-group">
              <label for="snlPolicyType">Policy Type</label>
              <select id="snlPolicyType">
                <option value="">Select Type</option>
                <option value="Auto">Auto Insurance</option>
                <option value="Home">Homeowners Insurance</option>
                <option value="Renters">Renters Insurance</option>
                <option value="Life">Life Insurance</option>
                <option value="Business">Business Insurance</option>
                <option value="Other">Other</option>
              </select>
            </div>
            
            <div class="snl-form-group">
              <label for="snlAmountPaid">Reinstatement Amount <span class="snl-required">*</span></label>
              <input type="text" id="snlAmountPaid" required placeholder="425.00">
            </div>
          </div>
          
          <div class="snl-section-title">Important Dates</div>
          
          <div class="snl-row">
            <div class="snl-form-group">
              <label for="snlCancelDate">Cancellation/Lapse Date <span class="snl-required">*</span></label>
              <input type="date" id="snlCancelDate" required>
            </div>
            
            <div class="snl-form-group">
              <label for="snlReinstateDate">Reinstatement Date <span class="snl-required">*</span></label>
              <input type="date" id="snlReinstateDate" required>
            </div>
          </div>
          
          <div class="snl-button-group">
            <button type="submit" class="snl-btn snl-btn-generate">üîó Generate Link</button>
          </div>
        </form>
        
        <div id="snlResultSection" class="snl-result-section">
          <h3>‚úÖ Link Generated Successfully!</h3>
          <p style="color: #856404; font-weight: bold; margin-bottom: 10px;">üìß This form sends to: Docs@BillLayneInsurance.com</p>
          
          <div class="snl-link-display" id="snlGeneratedLink"></div>
          
          <div class="snl-button-group">
            <button class="snl-btn snl-btn-copy" onclick="snlCopyLink()">üìã Copy Link</button>
            <button class="snl-btn snl-btn-open" onclick="snlOpenLink()">üîó Open Form</button>
            <button class="snl-btn snl-btn-clear" onclick="snlClearForm()">üîÑ Start Over</button>
          </div>
          
          <div class="snl-copy-status" id="snlCopyStatus">‚úî Link copied to clipboard!</div>
          
          <div class="snl-message-templates">
            <div class="snl-template">
              <h4>üì± Text Message Template:</h4>
              <div class="snl-template-text" id="snlTextTemplate"></div>
              <div style="display: flex; gap: 10px; margin-top: 10px;">
                <button class="snl-btn snl-btn-text" style="flex: 1;" onclick="snlCopyText()">Copy Text Message</button>
                <button class="snl-btn snl-btn-matrix" style="flex: 1;" onclick="snlOpenAgencyMatrix()">üîç Find in Agency Matrix</button>
              </div>
            </div>
            
            <div class="snl-template">
              <h4>üìß Email Template:</h4>
              <div class="snl-template-text" id="snlEmailTemplate"></div>
              <button class="snl-btn snl-btn-email" style="margin-top: 10px; width: 100%;" onclick="snlCopyEmail()">Copy Email</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <script>
      // Base URL for the No Loss Statement form - CORRECTED URL
      const SNL_BASE_URL = 'https://billlayne.github.io/no-loss-statement/';
      
      // Store the generated URL globally
      let snlCurrentGeneratedUrl = '';
      
      // Auto-format phone number
      document.getElementById('snlPhone').addEventListener('input', function(e) {
        let value = e.target.value.replace(/\D/g, '');
        if (value.length > 0) {
          if (value.length <= 3) {
            value = '(' + value;
          } else if (value.length <= 6) {
            value = '(' + value.slice(0, 3) + ') ' + value.slice(3);
          } else {
            value = '(' + value.slice(0, 3) + ') ' + value.slice(3, 6) + '-' + value.slice(6, 10);
          }
        }
        e.target.value = value;
      });
      
      // Auto-format amount
      document.getElementById('snlAmountPaid').addEventListener('blur', function(e) {
        let value = e.target.value.replace(/[^\d.]/g, '');
        if (value && !isNaN(value)) {
          e.target.value = parseFloat(value).toFixed(2);
        }
      });
      
      // Handle form submission
      document.getElementById('snlLinkGenerator').addEventListener('submit', function(e) {
        e.preventDefault();
        snlGenerateLink();
      });
      
      function snlGenerateLink() {
        // Get form values
        const name = document.getElementById('snlCustomerName').value;
        const email = document.getElementById('snlEmail').value;
        const phone = document.getElementById('snlPhone').value;
        const policyNumber = document.getElementById('snlPolicyNumber').value;
        const company = document.getElementById('snlInsuranceCompany').value;
        const policyType = document.getElementById('snlPolicyType').value;
        const amount = document.getElementById('snlAmountPaid').value;
        const cancelDate = document.getElementById('snlCancelDate').value;
        const reinstateDate = document.getElementById('snlReinstateDate').value;
        
        // Build URL parameters with CORRECT parameter names
        let params = new URLSearchParams();
        
        // FIXED: Using the correct parameter names that the form expects
        params.append('policyNumber', policyNumber);
        params.append('amountPaid', amount);
        params.append('insuranceCompany', company);
        params.append('insuredName', name);
        params.append('cancellationDate', cancelDate);
        params.append('reinstatementDate', reinstateDate);
        
        // Add optional fields with correct names
        if (email) params.append('email', email);
        if (phone) params.append('phone', phone);
        if (policyType) params.append('policyType', policyType);
        
        // Generate the full URL
        const fullUrl = SNL_BASE_URL + '?' + params.toString();
        
        // Store the URL globally
        snlCurrentGeneratedUrl = fullUrl;
        
        // Display the link
        document.getElementById('snlGeneratedLink').textContent = fullUrl;
        document.getElementById('snlResultSection').style.display = 'block';
        
        // Generate message templates
        snlGenerateTemplates(name, policyNumber, amount, cancelDate, reinstateDate, fullUrl);
        
        // Scroll to results
        document.getElementById('snlResultSection').scrollIntoView({ behavior: 'smooth' });
      }
      
      function snlGenerateTemplates(name, policy, amount, cancelDate, reinstateDate, url) {
        // Format dates for display
        const formatDate = (dateStr) => {
          const date = new Date(dateStr + 'T12:00:00');
          return date.toLocaleDateString('en-US', { month: 'numeric', day: 'numeric', year: 'numeric' });
        };
        
        const cancelFormatted = formatDate(cancelDate);
        const reinstateFormatted = formatDate(reinstateDate);
        const firstName = name.split(' ')[0];
        
        // Text message template
        const textMsg = `Hi ${firstName}, 

To reinstate your insurance policy #${policy}, please complete the No Loss Statement:

Amount: $${amount}
Cancelled: ${cancelFormatted}

Click here: ${url}

Just verify info & sign. Takes 2 minutes!

Questions? Call 336-835-1993

-Bill Layne Insurance`;
        
        // Email template
        const emailMsg = `Subject: Action Required - Complete No Loss Statement for Policy Reinstatement

Dear ${name},

To complete the reinstatement of your insurance policy, we need you to sign a Statement of No Loss.

Policy Details:
‚Ä¢ Policy Number: ${policy}
‚Ä¢ Cancellation Date: ${cancelFormatted}
‚Ä¢ Reinstatement Date: ${reinstateFormatted}
‚Ä¢ Amount Due: $${amount}

Please click the link below to complete the form. All your information has been pre-filled - you just need to verify and sign:

${url}

This takes less than 2 minutes to complete on any device.

If you have any questions, please don't hesitate to call us at 336-835-1993.

Thank you,
Bill Layne Insurance Agency
1283 N Bridge St, Elkin NC 28621
Save@BillLayneInsurance.com`;
        
        document.getElementById('snlTextTemplate').textContent = textMsg;
        document.getElementById('snlEmailTemplate').textContent = emailMsg;
      }
      
      function snlCopyLink() {
        const link = document.getElementById('snlGeneratedLink').textContent;
        navigator.clipboard.writeText(link).then(function() {
          snlShowCopyStatus('‚úî Link copied to clipboard!');
        }).catch(function(err) {
          // Fallback for older browsers
          const textArea = document.createElement('textarea');
          textArea.value = link;
          document.body.appendChild(textArea);
          textArea.select();
          document.execCommand('copy');
          document.body.removeChild(textArea);
          snlShowCopyStatus('‚úî Link copied to clipboard!');
        });
      }
      
      function snlOpenLink() {
        if (snlCurrentGeneratedUrl) {
          window.open(snlCurrentGeneratedUrl, '_blank');
        } else {
          alert('Please generate a link first');
        }
      }
      
      function snlCopyText() {
        const text = document.getElementById('snlTextTemplate').textContent;
        navigator.clipboard.writeText(text).then(function() {
          snlShowCopyStatus('‚úî Text message copied!');
        }).catch(function(err) {
          // Fallback for older browsers
          const textArea = document.createElement('textarea');
          textArea.value = text;
          document.body.appendChild(textArea);
          textArea.select();
          document.execCommand('copy');
          document.body.removeChild(textArea);
          snlShowCopyStatus('‚úî Text message copied!');
        });
      }
      
      function snlCopyEmail() {
        const email = document.getElementById('snlEmailTemplate').textContent;
        navigator.clipboard.writeText(email).then(function() {
          snlShowCopyStatus('‚úî Email template copied!');
        }).catch(function(err) {
          // Fallback for older browsers
          const textArea = document.createElement('textarea');
          textArea.value = email;
          document.body.appendChild(textArea);
          textArea.select();
          document.execCommand('copy');
          document.body.removeChild(textArea);
          snlShowCopyStatus('‚úî Email template copied!');
        });
      }
      
      function snlOpenAgencyMatrix() {
        const phoneValue = document.getElementById('snlPhone').value;
        
        if (!phoneValue) {
          alert('Please enter a phone number first');
          document.getElementById('snlPhone').focus();
          return;
        }
        
        // Strip all non-numeric characters from phone
        const phoneDigits = phoneValue.replace(/\D/g, '');
        
        if (phoneDigits.length < 10) {
          alert('Please enter a complete 10-digit phone number');
          return;
        }
        
        // First, copy the text message to clipboard
        const text = document.getElementById('snlTextTemplate').textContent;
        navigator.clipboard.writeText(text).then(function() {
          // Then open Agency Matrix
          const agencyMatrixUrl = `https://agents.agencymatrix.com/#/customer/search?selection=Phone&query=${phoneDigits}`;
          window.open(agencyMatrixUrl, '_blank');
          
          // Show status message
          snlShowCopyStatus('‚úî Text copied! Opening Agency Matrix - paste the message there');
        }).catch(function(err) {
          // Fallback if clipboard fails
          alert('Please copy the text message manually, then click OK to open Agency Matrix');
          const agencyMatrixUrl = `https://agents.agencymatrix.com/#/customer/search?selection=Phone&query=${phoneDigits}`;
          window.open(agencyMatrixUrl, '_blank');
        });
      }
      
      function snlShowCopyStatus(message = '‚úî Link copied to clipboard!') {
        const status = document.getElementById('snlCopyStatus');
        status.textContent = message;
        status.style.display = 'block';
        setTimeout(() => {
          status.style.display = 'none';
        }, 3000);
      }
      
      function snlClearForm() {
        document.getElementById('snlLinkGenerator').reset();
        document.getElementById('snlResultSection').style.display = 'none';
        snlCurrentGeneratedUrl = '';
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
      
      // Set today's date as default for reinstatement date
      document.addEventListener('DOMContentLoaded', function() {
        const today = new Date().toISOString().split('T')[0];
        const reinstateElement = document.getElementById('snlReinstateDate');
        if (reinstateElement) {
          reinstateElement.value = today;
        }
      });
    </script>
  </div>

  <!-- Cancellation Tab (ACORD 35 Cancellation Generator) -->
  <div id="cancellation-tab" class="tab-content" style="display: none;">
    <style>
      .cancel-container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        overflow: hidden;
      }
      
      .cancel-header {
        background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
        color: white;
        padding: 25px 20px;
        text-align: center;
      }
      
      .cancel-header h1 {
        font-size: 24px;
        margin-bottom: 10px;
      }
      
      .cancel-header p {
        font-size: 14px;
        opacity: 0.9;
      }
      
      .cancel-system-badge {
        display: inline-block;
        background: #dc3545;
        color: white;
        padding: 5px 15px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: bold;
        margin-top: 10px;
      }
      
      .cancel-form-container {
        padding: 25px 20px;
      }
      
      .cancel-section-title {
        background: #f8f9fa;
        padding: 10px 15px;
        margin: 20px -20px 15px -20px;
        font-weight: 600;
        color: #495057;
        border-left: 4px solid #dc3545;
      }
      
      .cancel-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin-bottom: 15px;
      }
      
      .cancel-form-group {
        display: flex;
        flex-direction: column;
      }
      
      .cancel-form-group.full-width {
        grid-column: span 2;
      }
      
      .cancel-form-group label {
        font-size: 13px;
        font-weight: 600;
        color: #495057;
        margin-bottom: 5px;
      }
      
      .cancel-form-group input,
      .cancel-form-group select,
      .cancel-form-group textarea {
        padding: 10px 12px;
        border: 1px solid #ddd;
        border-radius: 8px;
        font-size: 14px;
        transition: all 0.3s ease;
      }
      
      .cancel-form-group input:focus,
      .cancel-form-group select:focus,
      .cancel-form-group textarea:focus {
        outline: none;
        border-color: #007bff;
        box-shadow: 0 0 0 3px rgba(0,123,255,0.1);
      }
      
      .cancel-form-group textarea {
        resize: vertical;
        min-height: 100px;
      }
      
      .cancel-button-group {
        margin-top: 30px;
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 10px;
      }
      
      .cancel-btn {
        padding: 12px 20px;
        border: none;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      
      .cancel-btn-generate {
        background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
        color: white;
        grid-column: span 1;
      }
      
      .cancel-btn-generate:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(220,53,69,0.3);
      }
      
      .cancel-btn-test {
        background: #28a745;
        color: white;
      }
      
      .cancel-btn-test:hover {
        background: #218838;
      }
      
      .cancel-btn-clear {
        background: #6c757d;
        color: white;
      }
      
      .cancel-btn-clear:hover {
        background: #5a6268;
      }
      
      #cancelResultSection {
        display: none;
        margin-top: 30px;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 10px;
        border: 2px solid #28a745;
      }
      
      .cancel-result-title {
        font-size: 18px;
        font-weight: bold;
        color: #28a745;
        margin-bottom: 15px;
      }
      
      .cancel-url-display {
        background: white;
        padding: 15px;
        border-radius: 8px;
        word-break: break-all;
        font-family: 'Courier New', monospace;
        font-size: 13px;
        border: 1px solid #ddd;
        margin-bottom: 15px;
      }
      
      .cancel-action-buttons {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
      }
      
      .cancel-btn-action {
        padding: 10px 15px;
        border: none;
        border-radius: 6px;
        font-size: 13px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      
      .cancel-btn-copy {
        background: #007bff;
        color: white;
      }
      
      .cancel-btn-copy:hover {
        background: #0056b3;
      }
      
      .cancel-btn-email {
        background: #2196F3;
        color: white;
      }
      
      .cancel-btn-email:hover {
        background: #0b7dda;
      }
      
      .cancel-btn-preview {
        background: #17a2b8;
        color: white;
      }
      
      .cancel-btn-preview:hover {
        background: #138496;
      }
      
      .cancel-btn-text {
        background: #ffc107;
        color: #212529;
      }
      
      .cancel-btn-text:hover {
        background: #e0a800;
      }
      
      .cancel-text-template {
        background: #fff3cd;
        padding: 15px;
        border-radius: 8px;
        margin-top: 20px;
        border: 1px solid #ffc107;
        white-space: pre-wrap;
      }
      
      .cancel-copy-status {
        display: none;
        color: #28a745;
        font-weight: 600;
        text-align: center;
        margin-top: 10px;
      }
      
      .cancel-instructions {
        background: #fff3cd;
        border: 1px solid #ffc107;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 20px;
      }
      
      .cancel-instructions h4 {
        color: #856404;
        margin-bottom: 8px;
      }
      
      .cancel-instructions ol {
        margin-left: 20px;
        color: #856404;
        font-size: 14px;
      }
      
      .cancel-instructions li {
        margin-bottom: 5px;
      }
      
      .cancel-warning {
        color: #dc3545;
        font-weight: bold;
      }
      
      .cancel-notes-info {
        background: #d1ecf1;
        border: 1px solid #bee5eb;
        border-radius: 6px;
        padding: 10px;
        margin-top: 5px;
        font-size: 12px;
        color: #0c5460;
      }
      
      @media (max-width: 600px) {
        .cancel-row {
          grid-template-columns: 1fr;
        }
        
        .cancel-form-group.full-width {
          grid-column: span 1;
        }
        
        .cancel-button-group {
          grid-template-columns: 1fr;
        }
        
        .cancel-btn-generate {
          grid-column: span 1;
        }
        
        .cancel-action-buttons {
          grid-template-columns: 1fr;
        }
        
        .cancel-header h1 {
          font-size: 20px;
        }
      }
    </style>
    
    <div class="cancel-container">
      <div class="cancel-header">
        <h1>üìÑ ACORD 35 Cancellation Link Generator</h1>
        <p>Bill Layne Insurance Agency - Staff Tool</p>
        <span class="cancel-system-badge">‚ö†Ô∏è CANCELLATION SYSTEM</span>
      </div>
      
      <div class="cancel-form-container">
        <div class="cancel-instructions">
          <h4>üìå Instructions:</h4>
          <ol>
            <li>Fill in all customer and policy information</li>
            <li>Double-check cancellation date and time</li>
            <li>Add any special notes (optional)</li>
            <li>Click "Generate Link"</li>
            <li>Send link to customer for signature</li>
            <li class="cancel-warning">‚ö†Ô∏è This creates a cancellation request!</li>
          </ol>
        </div>
        
        <form id="cancelLinkGenerator">
          <div class="cancel-section-title">Customer Information</div>
          
          <div class="cancel-row">
            <div class="cancel-form-group full-width">
              <label>Insured Name *</label>
              <input type="text" id="cancelInsuredName" required>
            </div>
          </div>
          
          <div class="cancel-row">
            <div class="cancel-form-group full-width">
              <label>Address</label>
              <input type="text" id="cancelInsuredAddress">
            </div>
          </div>
          
          <div class="cancel-row">
            <div class="cancel-form-group">
              <label>Phone</label>
              <input type="tel" id="cancelInsuredPhone">
            </div>
            <div class="cancel-form-group">
              <label>Email</label>
              <input type="email" id="cancelInsuredEmail">
            </div>
          </div>
          
          <div class="cancel-section-title">Policy Information</div>
          
          <div class="cancel-row">
            <div class="cancel-form-group">
              <label>Policy Number *</label>
              <input type="text" id="cancelPolicyNumber" required>
            </div>
            <div class="cancel-form-group">
              <label>Insurance Company *</label>
              <select id="cancelCompany" required>
                <option value="">Select Company...</option>
                <option value="Progressive">Progressive</option>
                <option value="Nationwide">Nationwide</option>
                <option value="National General">National General</option>
                <option value="Alamance Farmers">Alamance Farmers</option>
                <option value="Travelers">Travelers</option>
                <option value="Foremost">Foremost</option>
                <option value="NC Grange">NC Grange</option>
                <option value="Other">Other</option>
              </select>
            </div>
          </div>
          
          <div class="cancel-row">
            <div class="cancel-form-group">
              <label>Policy Type *</label>
              <select id="cancelPolicyType" required>
                <option value="">Select Type...</option>
                <option value="Auto">Auto</option>
                <option value="Home">Home</option>
                <option value="Renters">Renters</option>
                <option value="Motorcycle">Motorcycle</option>
                <option value="RV">RV</option>
                <option value="Boat">Boat</option>
                <option value="Commercial">Commercial</option>
                <option value="Other">Other</option>
              </select>
            </div>
            <div class="cancel-form-group">
              <label>Effective Date</label>
              <input type="date" id="cancelEffectiveDate">
            </div>
          </div>
          
          <div class="cancel-row">
            <div class="cancel-form-group">
              <label>Expiration Date</label>
              <input type="date" id="cancelExpirationDate">
            </div>
          </div>
          
          <div class="cancel-section-title">Cancellation Details</div>
          
          <div class="cancel-row">
            <div class="cancel-form-group">
              <label>Cancellation Date *</label>
              <input type="date" id="cancelCancelDate" required>
            </div>
            <div class="cancel-form-group">
              <label>Cancellation Time</label>
              <select id="cancelCancelTime">
                <option value="12:01 AM">12:01 AM</option>
                <option value="12:01 PM" selected>12:01 PM</option>
                <option value="11:59 PM">11:59 PM</option>
              </select>
            </div>
          </div>
          
          <div class="cancel-row">
            <div class="cancel-form-group full-width">
              <label>Reason for Cancellation *</label>
              <select id="cancelReason" required>
                <option value="">Select Reason...</option>
                <option value="Insured Request">Insured Request</option>
                <option value="Non-Payment">Non-Payment</option>
                <option value="Rewritten">Rewritten with Another Carrier</option>
                <option value="Not Taken">Coverage Not Taken</option>
                <option value="Sold Property">Sold Property</option>
                <option value="Sold Vehicle">Sold Vehicle</option>
                <option value="No Longer Need">No Longer Need Coverage</option>
                <option value="Other">Other</option>
              </select>
            </div>
          </div>
          
          <div class="cancel-section-title">Special Notes (Optional)</div>
          
          <div class="cancel-row">
            <div class="cancel-form-group full-width">
              <label>Staff Notes / Special Instructions</label>
              <textarea id="cancelNotes" placeholder="Add any special notes or instructions here (e.g., pending refund check, follow-up required, etc.)"></textarea>
              <div class="cancel-notes-info">
                ‚ÑπÔ∏è These notes will appear on the PDF and in the Google Sheet but will NOT be visible to the customer
              </div>
            </div>
          </div>
          
          <div class="cancel-button-group">
            <button type="button" class="cancel-btn cancel-btn-generate" onclick="cancelGenerateLink()">
              üîó Generate Cancellation Link
            </button>
            <button type="button" class="cancel-btn cancel-btn-clear" onclick="cancelClearForm()">
              üîÑ Clear Form
            </button>
          </div>
        </form>
        
        <div id="cancelResultSection">
          <div class="cancel-result-title">‚úÖ Cancellation Link Generated!</div>
          <div class="cancel-url-display" id="cancelGeneratedUrl"></div>
          
          <div class="cancel-action-buttons">
            <button class="cancel-btn-action cancel-btn-copy" onclick="cancelCopyLink()">
              üìã Copy Link
            </button>
            <button class="cancel-btn-action cancel-btn-email" onclick="cancelEmailToCustomer()">
              üìß Email Customer
            </button>
            <button class="cancel-btn-action cancel-btn-text" onclick="cancelSendToAgencyMatrix()">
              üì± Text Customer
            </button>
          </div>
          
          <div class="cancel-text-template" id="cancelTextTemplate" style="display: none;">
            <strong>üì± Text Message Template:</strong><br><br>
            <span id="cancelTextMessage"></span>
            <br><br>
            <button class="cancel-btn-action cancel-btn-copy" style="width: 100%; margin-bottom: 10px;" onclick="cancelCopyTextMessage()">
              üìã Copy Text Message
            </button>
          </div>
          
          <div class="cancel-text-template" id="cancelEmailTemplate" style="display: none; margin-top: 15px;">
            <strong>üìß Email Template:</strong><br><br>
            <span id="cancelEmailMessage"></span>
            <br><br>
            <button class="cancel-btn-action cancel-btn-copy" style="width: 100%;" onclick="cancelCopyEmailMessage()">
              üìã Copy Email Template
            </button>
          </div>
          
          <div class="cancel-copy-status" id="cancelCopyStatus"></div>
        </div>
      </div>
    </div>
    
    <script>
      let cancelCurrentGeneratedUrl = '';
      
      function cancelGenerateLink() {
        // Get form values
        const insuredName = document.getElementById('cancelInsuredName').value;
        const policyNumber = document.getElementById('cancelPolicyNumber').value;
        const company = document.getElementById('cancelCompany').value;
        const policyType = document.getElementById('cancelPolicyType').value;
        const cancelDate = document.getElementById('cancelCancelDate').value;
        const reason = document.getElementById('cancelReason').value;
        
        // Validate required fields
        if (!insuredName || !policyNumber || !company || !policyType || !cancelDate || !reason) {
          alert('Please fill in all required fields marked with *');
          return;
        }
        
        // Build URL parameters
        const params = new URLSearchParams({
          insuredName: insuredName,
          insuredAddress: document.getElementById('cancelInsuredAddress').value || '',
          insuredPhone: document.getElementById('cancelInsuredPhone').value || '',
          insuredEmail: document.getElementById('cancelInsuredEmail').value || '',
          policyNumber: policyNumber,
          company: company,
          policyType: policyType,
          effectiveDate: document.getElementById('cancelEffectiveDate').value || '',
          expirationDate: document.getElementById('cancelExpirationDate').value || '',
          cancelDate: cancelDate,
          cancelTime: document.getElementById('cancelCancelTime').value || '12:01 PM',
          reason: reason,
          notes: document.getElementById('cancelNotes').value || ''
        });
        
        // Generate the URL
        const baseUrl = 'https://billlayne.github.io/cancellation-form/';
        cancelCurrentGeneratedUrl = baseUrl + '?' + params.toString();
        
        // Display result
        document.getElementById('cancelGeneratedUrl').textContent = cancelCurrentGeneratedUrl;
        document.getElementById('cancelResultSection').style.display = 'block';
        
        // Generate text message
        const phone = document.getElementById('cancelInsuredPhone').value || 'No phone';
        const textMsg = `Hi ${insuredName.split(' ')[0]},\n\nPer your request, here's the link to sign your ${policyType} policy cancellation form (Policy: ${policyNumber}).\n\nCancellation Date: ${cancelFormatDate(cancelDate)} at ${document.getElementById('cancelCancelTime').value}\n\nPlease review and sign:\n${cancelCurrentGeneratedUrl}\n\nThank you,\nBill Layne Insurance Agency\n336-835-1993`;
        
        // Generate email template
        const emailMsg = `Subject: Action Required - Sign Cancellation Request for Policy ${policyNumber}\n\nDear ${insuredName},\n\nPer your request to cancel your ${policyType} policy, please complete the electronic cancellation form.\n\nPolicy Details:\n‚Ä¢ Policy Number: ${policyNumber}\n‚Ä¢ Insurance Company: ${company}\n‚Ä¢ Cancellation Date: ${cancelFormatDate(cancelDate)}\n‚Ä¢ Cancellation Time: ${document.getElementById('cancelCancelTime').value}\n‚Ä¢ Reason: ${reason}\n\nPlease click the link below to review and sign your cancellation request:\n\n${cancelCurrentGeneratedUrl}\n\nIMPORTANT: Your coverage will terminate on the date and time shown above. Please ensure you have replacement coverage if needed.\n\nIf you have any questions or wish to discuss alternatives, please call us at 336-835-1993.\n\nThank you,\nBill Layne Insurance Agency\n1283 N Bridge St, Elkin NC 28621\nSave@BillLayneInsurance.com`;
        
        document.getElementById('cancelTextMessage').textContent = textMsg;
        document.getElementById('cancelEmailMessage').textContent = emailMsg;
        document.getElementById('cancelTextTemplate').style.display = 'block';
        document.getElementById('cancelEmailTemplate').style.display = 'block';
        
        // Scroll to results
        document.getElementById('cancelResultSection').scrollIntoView({ behavior: 'smooth' });
      }
      
      function cancelFormatDate(dateString) {
        const date = new Date(dateString + 'T00:00:00');
        return date.toLocaleDateString('en-US', { month: 'numeric', day: 'numeric', year: 'numeric' });
      }
      
      function cancelCopyLink() {
        navigator.clipboard.writeText(cancelCurrentGeneratedUrl).then(function() {
          cancelShowCopyStatus('‚úî Link copied to clipboard!');
        }).catch(function(err) {
          // Fallback for older browsers
          const textArea = document.createElement('textarea');
          textArea.value = cancelCurrentGeneratedUrl;
          document.body.appendChild(textArea);
          textArea.select();
          document.execCommand('copy');
          document.body.removeChild(textArea);
          cancelShowCopyStatus('‚úî Link copied to clipboard!');
        });
      }
      
      function cancelEmailToCustomer() {
        const insuredName = document.getElementById('cancelInsuredName').value;
        const insuredEmail = document.getElementById('cancelInsuredEmail').value;
        const policyNumber = document.getElementById('cancelPolicyNumber').value;
        const policyType = document.getElementById('cancelPolicyType').value;
        const cancelDate = document.getElementById('cancelCancelDate').value;
        const cancelTime = document.getElementById('cancelCancelTime').value;
        const reason = document.getElementById('cancelReason').value;
        const company = document.getElementById('cancelCompany').value;
        
        if (!insuredEmail) {
          alert('Please enter customer email address first');
          document.getElementById('cancelInsuredEmail').focus();
          return;
        }
        
        // Create email subject
        const subject = `Action Required - Sign Cancellation Request for Policy ${policyNumber}`;
        
        // Create email body
        const body = `Dear ${insuredName},

Per your request to cancel your ${policyType} policy, please complete the electronic cancellation form.

Policy Details:
‚Ä¢ Policy Number: ${policyNumber}
‚Ä¢ Insurance Company: ${company}
‚Ä¢ Cancellation Date: ${cancelFormatDate(cancelDate)}
‚Ä¢ Cancellation Time: ${cancelTime}
‚Ä¢ Reason: ${reason}

Please click the link below to review and sign your cancellation request:

${cancelCurrentGeneratedUrl}

IMPORTANT: Your coverage will terminate on the date and time shown above. Please ensure you have replacement coverage if needed.

If you have any questions or wish to discuss alternatives, please call us at 336-835-1993.

Thank you,
Bill Layne Insurance Agency
1283 N Bridge St, Elkin NC 28621
Save@BillLayneInsurance.com`;
        
        // Copy the email content to clipboard
        const emailContent = `To: ${insuredEmail}\nSubject: ${subject}\n\n${body}`;
        navigator.clipboard.writeText(emailContent).then(function() {
          cancelShowCopyStatus('‚úî Email copied! Opening Gmail...');
        }).catch(function(err) {
          // Fallback if clipboard fails
          const textArea = document.createElement('textarea');
          textArea.value = emailContent;
          document.body.appendChild(textArea);
          textArea.select();
          document.execCommand('copy');
          document.body.removeChild(textArea);
          cancelShowCopyStatus('‚úî Email copied! Opening Gmail...');
        });
        
        // Open Gmail compose in new tab
        const gmailUrl = `https://mail.google.com/mail/?view=cm&fs=1&to=${encodeURIComponent(insuredEmail)}&su=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
        window.open(gmailUrl, '_blank');
      }
      
      function cancelCopyTextMessage() {
        const text = document.getElementById('cancelTextMessage').textContent;
        navigator.clipboard.writeText(text).then(function() {
          cancelShowCopyStatus('‚úî Text message copied!');
        }).catch(function(err) {
          const textArea = document.createElement('textarea');
          textArea.value = text;
          document.body.appendChild(textArea);
          textArea.select();
          document.execCommand('copy');
          document.body.removeChild(textArea);
          cancelShowCopyStatus('‚úî Text message copied!');
        });
      }
      
      function cancelCopyEmailMessage() {
        const email = document.getElementById('cancelEmailMessage').textContent;
        navigator.clipboard.writeText(email).then(function() {
          cancelShowCopyStatus('‚úî Email template copied!');
        }).catch(function(err) {
          const textArea = document.createElement('textarea');
          textArea.value = email;
          document.body.appendChild(textArea);
          textArea.select();
          document.execCommand('copy');
          document.body.removeChild(textArea);
          cancelShowCopyStatus('‚úî Email template copied!');
        });
      }
      
      function cancelSendToAgencyMatrix() {
        const phone = document.getElementById('cancelInsuredPhone').value;
        
        if (!phone) {
          alert('Please enter a phone number to use Agency Matrix');
          document.getElementById('cancelInsuredPhone').focus();
          return;
        }
        
        const phoneDigits = phone.replace(/\D/g, '');
        
        if (phoneDigits.length < 10) {
          alert('Please enter a complete 10-digit phone number');
          return;
        }
        
        const textMessage = document.getElementById('cancelTextMessage').textContent;
        
        navigator.clipboard.writeText(textMessage).then(function() {
          cancelShowCopyStatus('‚úî Text copied! Opening Agency Matrix - paste the message there');
          setTimeout(() => {
            const agencyMatrixUrl = `https://agents.agencymatrix.com/#/customer/search?selection=Phone&query=${phoneDigits}`;
            window.open(agencyMatrixUrl, '_blank');
          }, 1000);
        }).catch(function(err) {
          alert('Please copy the text message manually, then click OK to open Agency Matrix');
          const agencyMatrixUrl = `https://agents.agencymatrix.com/#/customer/search?selection=Phone&query=${phoneDigits}`;
          window.open(agencyMatrixUrl, '_blank');
        });
      }
      
      function cancelShowCopyStatus(message = '‚úî Link copied to clipboard!') {
        const status = document.getElementById('cancelCopyStatus');
        status.textContent = message;
        status.style.display = 'block';
        setTimeout(() => {
          status.style.display = 'none';
        }, 3000);
      }
      
      function cancelClearForm() {
        if (confirm('Are you sure you want to clear all fields?')) {
          document.getElementById('cancelLinkGenerator').reset();
          document.getElementById('cancelResultSection').style.display = 'none';
          cancelCurrentGeneratedUrl = '';
          window.scrollTo({ top: 0, behavior: 'smooth' });
        }
      }
      
      // Set default values
      document.addEventListener('DOMContentLoaded', function() {
        // Set today's date as default for cancellation date
        const today = new Date().toISOString().split('T')[0];
        const cancelDateElement = document.getElementById('cancelCancelDate');
        if (cancelDateElement) {
          cancelDateElement.value = today;
        }
        
        // Auto-format phone number
        const phoneElement = document.getElementById('cancelInsuredPhone');
        if (phoneElement) {
          phoneElement.addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length > 0) {
              if (value.length <= 3) {
                value = '(' + value;
              } else if (value.length <= 6) {
                value = '(' + value.slice(0, 3) + ') ' + value.slice(3);
              } else {
                value = '(' + value.slice(0, 3) + ') ' + value.slice(3, 6) + '-' + value.slice(6, 10);
              }
            }
            e.target.value = value;
          });
        }
      });
    </script>
  </div>

  <!-- PDF Viewer Modal -->
  <div id="pdfModal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="pdfTitle"></h3>
        <span class="close" onclick="closePDFModal()">&times;</span>
      </div>
      <div class="modal-body">
        <iframe id="pdfViewer" style="width: 100%; height: 600px; border: none;"></iframe>
      </div>
      <div class="modal-footer">
        <button onclick="downloadCurrentPDF()">‚¨áÔ∏è Download</button>
        <button onclick="printCurrentPDF()">üñ®Ô∏è Print</button>
        <button onclick="emailCurrentPDF()">üìß Email</button>
      </div>
    </div>
  </div>

  <!-- Helper function for downloading HTML files -->
  <script>
    function downloadHtmlFile(elementId, title) {
      const element = document.getElementById(elementId);
      const html = element.innerHTML;
      
      const fullHtml = `
        <!DOCTYPE html>
        <html>
        <head>
          <meta charset="UTF-8">
          <title>${title}</title>
        </head>
        <body>
          ${html}
        </body>
        </html>
      `;
      
      const blob = new Blob([fullHtml], { type: 'text/html' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      const fileName = `${title.replace(/\s+/g, '_')}.html`;
      
      a.href = url;
      a.download = fileName;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      
      showNotification(`Document saved as ${fileName}`, 'success');
    }
  </script>

  <!-- Load external JavaScript -->
  <script src="js/scripts.js"></script>
</body>
</html>